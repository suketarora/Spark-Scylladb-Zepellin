{"paragraphs":[{"text":"%md\n## Anomaly detection and pattern extraction with Spark, Scylla, and Scala\n\nToday, geolocated data is available in a number of domains, ranging from healthcare to financial markets to social services. In all these domains, extracting patterns, and detecting anomalies and novelties from data has very concrete business outcomes. \n\nAnomaly detection can be defined as the process of finding which samples in the given dataset do not follow the given patterns and behave as though they were produced by a different mechanism. From detection follows action. Depending on the domain and the use case, we define them as anomalies or novelties, and these signals are the triggers for applications such as personalized marketing, and fraud alerting and notification.\n\nAs more data gets ingested or produced via digital services, it’s key to perform this sort of analytics at scale. In the open source space, technologies such as Spark and Cassandra/Scylla are definitely instrumental to implement and execute modern data pipelines at scale.\n\n#### Synopsis\n\nThis notebook is divided into two parts: First, I will show how to collect data from Scylla and bring it up to Spark for further analysis. We will see how to prepare the data using a combination of Spark and Cassandra/Scylla queries. Then we will perform the following data analyses:\n\n  - Descriptive statistics \n  - Events histograms\n  - Extract users' preferences\n  - Detect novel/anomalous events\n","user":"anonymous","dateUpdated":"2019-01-17T11:23:26+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Anomaly detection and pattern extraction with Spark, Scylla, and Scala</h2>\n<p>Today, geolocated data is available in a number of domains, ranging from healthcare to financial markets to social services. In all these domains, extracting patterns, and detecting anomalies and novelties from data has very concrete business outcomes. </p>\n<p>Anomaly detection can be defined as the process of finding which samples in the given dataset do not follow the given patterns and behave as though they were produced by a different mechanism. From detection follows action. Depending on the domain and the use case, we define them as anomalies or novelties, and these signals are the triggers for applications such as personalized marketing, and fraud alerting and notification.</p>\n<p>As more data gets ingested or produced via digital services, it’s key to perform this sort of analytics at scale. In the open source space, technologies such as Spark and Cassandra/Scylla are definitely instrumental to implement and execute modern data pipelines at scale.</p>\n<h4>Synopsis</h4>\n<p>This notebook is divided into two parts: First, I will show how to collect data from Scylla and bring it up to Spark for further analysis. We will see how to prepare the data using a combination of Spark and Cassandra/Scylla queries. Then we will perform the following data analyses:</p>\n<ul>\n  <li>Descriptive statistics</li>\n  <li>Events histograms</li>\n  <li>Extract users&rsquo; preferences</li>\n  <li>Detect novel/anomalous events</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1547704402389_-1325546091","id":"20190117-112322_1188697716","dateCreated":"2019-01-17T11:23:22+0530","dateStarted":"2019-01-17T11:23:26+0530","dateFinished":"2019-01-17T11:23:26+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2003"},{"text":"%cassandra\nDROP KEYSPACE IF EXISTS lbsn;\n","user":"anonymous","dateUpdated":"2019-01-17T21:57:20+0530","config":{"colWidth":3,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<div class=\"container\">\n<div class=\"row text-center\">\n<h4>No Result</h4>\n</div>\n<br/>\n    <div class=\"row\">\n    <div class=\"col-md-3\"></div>\n    <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n        <table class=\"table\">\n            <caption><h5>Last query execution info</h5></caption>\n            <thead>\n                <tr>\n                    <th>Info</th>\n                    <th>Value</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Statement</td>\n                    <td>DROP KEYSPACE IF EXISTS lbsn;</td>\n                </tr>\n                <tr>\n                    <td>Achieved Consistency</td>\n                    <td>N/A</td>\n                </tr>\n                <tr>\n                    <td>Tried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Queried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Schema In Agreement</td>\n                    <td>true</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    </div>\n</div>"}]},"apps":[],"jobName":"paragraph_1547700560462_-2038734450","id":"20190117-101920_974327357","dateCreated":"2019-01-17T10:19:20+0530","dateStarted":"2019-01-17T10:31:24+0530","dateFinished":"2019-01-17T10:31:25+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2004"},{"text":"%cassandra\nCREATE KEYSPACE IF NOT EXISTS lbsn \nWITH replication = {'class': 'SimpleStrategy', 'replication_factor': 1};\n","user":"anonymous","dateUpdated":"2019-01-17T21:57:42+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":487,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<div class=\"container\">\n<div class=\"row text-center\">\n<h4>No Result</h4>\n</div>\n<br/>\n    <div class=\"row\">\n    <div class=\"col-md-3\"></div>\n    <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n        <table class=\"table\">\n            <caption><h5>Last query execution info</h5></caption>\n            <thead>\n                <tr>\n                    <th>Info</th>\n                    <th>Value</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Statement</td>\n                    <td>CREATE KEYSPACE IF NOT EXISTS lbsn \nWITH replication = {'class': 'SimpleStrategy', 'replication_factor': 1};</td>\n                </tr>\n                <tr>\n                    <td>Achieved Consistency</td>\n                    <td>N/A</td>\n                </tr>\n                <tr>\n                    <td>Tried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Queried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Schema In Agreement</td>\n                    <td>true</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    </div>\n</div>"}]},"apps":[],"jobName":"paragraph_1547700462368_469648764","id":"20190117-101742_851356785","dateCreated":"2019-01-17T10:17:42+0530","dateStarted":"2019-01-17T10:31:40+0530","dateFinished":"2019-01-17T10:31:41+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2005"},{"text":"%cassandra\nUSE lbsn;","user":"anonymous","dateUpdated":"2019-01-17T21:57:36+0530","config":{"colWidth":3,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<div class=\"container\">\n<div class=\"row text-center\">\n<h4>No Result</h4>\n</div>\n<br/>\n    <div class=\"row\">\n    <div class=\"col-md-3\"></div>\n    <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n        <table class=\"table\">\n            <caption><h5>Last query execution info</h5></caption>\n            <thead>\n                <tr>\n                    <th>Info</th>\n                    <th>Value</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Statement</td>\n                    <td>USE lbsn;</td>\n                </tr>\n                <tr>\n                    <td>Achieved Consistency</td>\n                    <td>N/A</td>\n                </tr>\n                <tr>\n                    <td>Tried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Queried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Schema In Agreement</td>\n                    <td>true</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    </div>\n</div>"}]},"apps":[],"jobName":"paragraph_1547701300114_1558174457","id":"20190117-103140_1695985331","dateCreated":"2019-01-17T10:31:40+0530","dateStarted":"2019-01-17T10:32:04+0530","dateFinished":"2019-01-17T10:32:04+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2006"},{"text":"%cassandra\nCREATE TABLE lbsn.events (\n  uid     bigint,\n  ts      timestamp,\n  lat     double,\n  lon     double,\n  vid     bigint,\n  PRIMARY KEY (uid, ts)\n) WITH CLUSTERING ORDER BY (ts DESC);\n","user":"anonymous","dateUpdated":"2019-01-17T21:57:54+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<div class=\"container\">\n<div class=\"row text-center\">\n<h4>No Result</h4>\n</div>\n<br/>\n    <div class=\"row\">\n    <div class=\"col-md-3\"></div>\n    <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n        <table class=\"table\">\n            <caption><h5>Last query execution info</h5></caption>\n            <thead>\n                <tr>\n                    <th>Info</th>\n                    <th>Value</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Statement</td>\n                    <td>CREATE TABLE lbsn.events (\n  uid     bigint,\n  ts      timestamp,\n  lat     double,\n  lon     double,\n  vid     bigint,\n  PRIMARY KEY (uid, ts)\n) WITH CLUSTERING ORDER BY (ts DESC);</td>\n                </tr>\n                <tr>\n                    <td>Achieved Consistency</td>\n                    <td>N/A</td>\n                </tr>\n                <tr>\n                    <td>Tried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Queried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Schema In Agreement</td>\n                    <td>true</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    </div>\n</div>"}]},"apps":[],"jobName":"paragraph_1547701324878_-1270560127","id":"20190117-103204_1462581067","dateCreated":"2019-01-17T10:32:04+0530","dateStarted":"2019-01-17T10:32:24+0530","dateFinished":"2019-01-17T10:32:27+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2007"},{"text":"%cassandra\nCREATE TABLE lbsn.users (\n  uid     bigint,\n  id      bigint,\n  PRIMARY KEY (uid, id)\n);\n\nCREATE TABLE lbsn.venues (\n  vid   bigint, \n  name  text,\n  lat   double,\n  lon   double,\n  PRIMARY KEY (vid)\n);","user":"anonymous","dateUpdated":"2019-01-17T21:58:00+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<div class=\"container\">\n<div class=\"row text-center\">\n<h4>No Result</h4>\n</div>\n<br/>\n    <div class=\"row\">\n    <div class=\"col-md-3\"></div>\n    <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n        <table class=\"table\">\n            <caption><h5>Last query execution info</h5></caption>\n            <thead>\n                <tr>\n                    <th>Info</th>\n                    <th>Value</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Statement</td>\n                    <td>CREATE TABLE lbsn.venues (\n  vid   bigint, \n  name  text,\n  lat   double,\n  lon   double,\n  PRIMARY KEY (vid)\n);</td>\n                </tr>\n                <tr>\n                    <td>Achieved Consistency</td>\n                    <td>N/A</td>\n                </tr>\n                <tr>\n                    <td>Tried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Queried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Schema In Agreement</td>\n                    <td>true</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    </div>\n</div>"}]},"apps":[],"jobName":"paragraph_1547701344859_20597083","id":"20190117-103224_661857280","dateCreated":"2019-01-17T10:32:24+0530","dateStarted":"2019-01-17T10:32:44+0530","dateFinished":"2019-01-17T10:32:48+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2008"},{"text":"%cassandra\nDESC TABLES;","user":"anonymous","dateUpdated":"2019-01-17T10:33:36+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<br/>\n<br/>\n<nav class=\"navbar navbar-default\">\n    <ul class=\"nav navbar-nav\">\n        \n\n<li role=\"presentation\" class=\"dropdown\">\n    <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n        <span class=\"text-muted\"><i class=\"glyphicon glyphicon-dashboard\"/>&nbsp;<strong>Test Cluster</strong></span>\n        <span class=\"text-muted caret\"></span>\n        <ul class=\"dropdown-menu\">\n            <li class=\"dropdown-header\"><span class=\"text-danger\">Keyspaces</span></li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f199f70-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;catalog</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19c680-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;keyspace1</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19c681-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;lbsn</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19c682-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;stocks</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19c683-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed90-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system_auth</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed91-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system_distributed</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed92-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system_schema</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed93-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system_traces</span>\n                </a>\n            </li>\n                        <li>\n                <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed94-1a15-11e9-aafd-d12617b12888\">\n                    <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;tracking</span>\n                </a>\n            </li>\n                    </ul>\n    </a>\n</li>\n\n        <li>\n            <a><strong>DESCRIBE TABLES;</strong></a>\n        </li>\n    </ul>\n    <ul class=\"nav navbar-nav navbar-right\">\n        <li class=\"dropdown\">\n            <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <strong>Legend</strong>\n                <span class=\"caret\"></span>\n            </a>\n            <ul class=\"dropdown-menu\">\n                <li>\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-dashboard text-muted\" />&nbsp;Cluster\n                    </a>\n                </li>\n                <li>\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-folder-open text-danger\" />&nbsp;&nbsp;Keyspace\n                    </a>\n                </li>\n                <li>\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-copyright-mark text-warning\" />&nbsp;&nbsp;UDT\n                    </a>\n                </li>\n                <li>\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-th-list text-primary\" />&nbsp;&nbsp;Table\n                    </a>\n                </li>\n                <li>\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-eye-open text-primary\" />&nbsp;&nbsp;Materialized View\n                    </a>\n                </li>\n                <li>\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-random text-success\" />&nbsp;&nbsp;Function\n                    </a>\n                </li>\n                <li>\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-retweet text-success\" />&nbsp;&nbsp;Aggregate\n                    </a>\n                </li>\n                <li role=\"separator\" class=\"divider text-muted\"></li>\n                <li class=\"dropdown-header\"><span class=\"text-primary\">Table icons</span></li>\n                <li class=\"bg-info\">\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-fullscreen\" />&nbsp;&nbsp;Partition Key\n                    </a>\n                </li>\n                <li class=\"bg-warning\">\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-pushpin\" />&nbsp;&nbsp;Static Column\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-sort\" />&nbsp;&nbsp;Clustering Column\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-sort-by-attributes\" />&nbsp;&nbsp;Clustering Order ASC\n                    </a>\n                </li>\n                <li class=\"bg-success\">\n                    <a role=\"button\">\n                        <i class=\"glyphicon glyphicon-sort-by-attributes-alt\" />&nbsp;&nbsp;Clustering Order DESC\n                    </a>\n                </li>\n            </ul>\n        </li>\n        <li>\n            <a href=\"#\"></a>\n        </li>\n    </ul>\n</nav>\n<hr/>\n\n\n<div class=\"container\">\n\n    <div class=\"row\">\n        <div class=\"panel-group\" role=\"tablist\" aria-multiselectable=\"true\">\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f199f70-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;catalog</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f199f70-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>mutant_data</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19c680-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;keyspace1</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19c680-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>standard1</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19c681-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;lbsn</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19c681-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>events</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>users</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>venues</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19c682-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;stocks</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19c682-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>stocks</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19c683-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19c683-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>IndexInfo</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>batchlog</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>built_views</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>compaction_history</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>compactions_in_progress</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>hints</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>large_partitions</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>local</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>paxos</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>peer_events</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>peers</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>range_xfers</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>scylla_views_builds_in_progress</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>size_estimates</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>sstable_activity</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>views_builds_in_progress</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed90-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system_auth</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19ed90-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>role_members</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>roles</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed91-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system_distributed</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19ed91-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>view_build_status</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed92-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system_schema</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19ed92-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>aggregates</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>columns</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>dropped_columns</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>functions</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>indexes</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>keyspaces</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>scylla_tables</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>tables</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>triggers</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>types</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>views</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed93-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;system_traces</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19ed93-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>events</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>node_slow_log</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>node_slow_log_time_idx</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>sessions</td></tr>\n                                        \n                                        <tr class=\"text-primary\"><td>sessions_time_idx</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                        <div class=\"panel panel-default\">\n                <div class=\"panel-heading\" role=\"tab\">\n                    <h4 class=\"panel-title\">\n                        <a role=\"button\" data-toggle=\"collapse\" data-target=\"#3f19ed94-1a15-11e9-aafd-d12617b12888\" aria-expanded=\"false\">\n                            <span class=\"text-danger\"><i class=\"glyphicon glyphicon-folder-open\"/>&nbsp;&nbsp;tracking</span>\n                        </a>\n                    </h4>\n                </div>\n                <div id=\"3f19ed94-1a15-11e9-aafd-d12617b12888\" class=\"panel-collapse collapse\" role=\"tabpanel\">\n                    <div class=\"panel-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-2\"/>\n                            <div class=\"col-md-8 col-offset-md-2 table-responsive table-bordered\">\n                                <table class=\"table\">\n                                    <thead>\n                                        <tr><th>Tables</th></tr>\n                                    </thead>\n                                    <tbody>\n                                        \n                                        <tr class=\"text-primary\"><td>tracking_data</td></tr>\n                                        \n                                    </tbody>\n                                </table>\n                            </div>\n                            <div class=\"col-md-2\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                    </div>\n    </div>\n</div>"}]},"apps":[],"jobName":"paragraph_1547701364528_-1836015324","id":"20190117-103244_763343399","dateCreated":"2019-01-17T10:32:44+0530","dateStarted":"2019-01-17T10:33:36+0530","dateFinished":"2019-01-17T10:33:41+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2009"},{"text":"%cassandra\n\n// ---------------------------------------------------------These commands will clear tables.-------------------------------------------------\n\n// TRUNCATE lbsn.events;\n// TRUNCATE lbsn.users;\n// TRUNCATE lbsn.venues;","user":"anonymous","dateUpdated":"2019-01-17T11:08:16+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"\n\n<div class=\"container\">\n<div class=\"row text-center\">\n<h4>No Result</h4>\n</div>\n<br/>\n    <div class=\"row\">\n    <div class=\"col-md-3\"></div>\n    <div class=\"col-md-6 col-offset-md-3 table-responsive table-bordered\">\n        <table class=\"table\">\n            <caption><h5>Last query execution info</h5></caption>\n            <thead>\n                <tr>\n                    <th>Info</th>\n                    <th>Value</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Statement</td>\n                    <td>TRUNCATE lbsn.events;</td>\n                </tr>\n                <tr>\n                    <td>Achieved Consistency</td>\n                    <td>N/A</td>\n                </tr>\n                <tr>\n                    <td>Tried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Queried Hosts</td>\n                    <td>localhost127.0.0.1:9042</td>\n                </tr>\n                <tr>\n                    <td>Schema In Agreement</td>\n                    <td>true</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    </div>\n</div>"}]},"apps":[],"jobName":"paragraph_1547701386306_1686871043","id":"20190117-103306_358369805","dateCreated":"2019-01-17T10:33:06+0530","dateStarted":"2019-01-17T10:52:17+0530","dateFinished":"2019-01-17T10:52:26+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2010"},{"text":"%cassandra\n\n// ---------------------------------------------Use this in cqlsh terminal.---------------------------------------------\n\n// COPY lbsn.events (uid, ts, lat, lon, vid) FROM '/home/pal/cql/gowalla_events.nyc.csv' with DELIMITER='\\t';\n\n// copy lbsn.users (uid, id) from '/home/pal/cql/gowalla_users.nyc.csv' with DELIMITER = '\\t';\n\n// COPY lbsn.venues (vid,name,lat,lon) FROM '/home/pal/cql/gowalla_venues.nyc.csv' with DELIMITER = '\\t';\n","user":"anonymous","dateUpdated":"2019-01-17T11:06:02+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1547703140402_-1634499579","id":"20190117-110220_1382380776","dateCreated":"2019-01-17T11:02:20+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2011"},{"text":"%cassandra\nSELECT * from lbsn.events LIMIT 20;\n","user":"anonymous","dateUpdated":"2019-01-17T21:54:40+0530","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uid":"string","ts":"string","lat":"string","lon":"string","vid":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"uid\tts\tlat\tlon\tvid\n118712\tMon Jun 28 11:12:51 IST 2010\t40.7603325169\t-73.965363295\t286922\n118712\tSun Jun 27 23:17:59 IST 2010\t40.7608565\t-73.96105629\t740461\n118712\tSun Jun 27 20:07:34 IST 2010\t40.757066887\t-73.98652553560001\t11847\n118712\tSun Jun 27 20:07:14 IST 2010\t40.7564238408\t-73.9864705503\t238964\n118712\tSun Jun 27 15:54:05 IST 2010\t40.757383836399995\t-73.9856350422\t48518\n118712\tSun Jun 27 15:13:06 IST 2010\t40.7474237391\t-73.985386048\t598725\n118712\tSun Jun 27 14:28:53 IST 2010\t40.7442251028\t-73.9874696732\t208429\n118712\tSun Jun 27 11:01:31 IST 2010\t40.7681673419\t-73.9816653728\t11828\n118712\tSat Jun 26 22:27:11 IST 2010\t40.7619360147\t-73.9834974135\t46939\n118712\tSat Jun 26 20:37:29 IST 2010\t40.760579923\t-73.95824211829999\t560886\n29720\tSat Oct 02 21:12:30 IST 2010\t40.7745128225\t-73.948212631\t353503\n29720\tSun Aug 01 15:50:37 IST 2010\t40.769564786\t-73.95768773\t1542343\n29720\tMon Jul 26 19:57:55 IST 2010\t40.7442982592\t-73.9839720726\t492214\n29720\tSat Jul 24 12:33:06 IST 2010\t40.7695077017\t-73.9519607967\t810542\n29720\tSat Jun 12 13:42:40 IST 2010\t40.7695077017\t-73.9519607967\t810542\n29720\tSun Jun 06 12:08:01 IST 2010\t40.7695077017\t-73.9519607967\t810542\n29720\tSun May 30 13:01:41 IST 2010\t40.7697337758\t-73.9543916458\t19706\n29720\tSat May 29 18:24:30 IST 2010\t40.770431644\t-73.9541541716\t971416\n29720\tFri May 28 19:52:41 IST 2010\t40.7717018706\t-73.8658475876\t361642\n29720\tFri May 28 14:17:35 IST 2010\t40.7697337758\t-73.9543916458\t19706\n"}]},"apps":[],"jobName":"paragraph_1547701823271_-47434367","id":"20190117-104023_529025322","dateCreated":"2019-01-17T10:40:23+0530","dateStarted":"2019-01-17T11:02:04+0530","dateFinished":"2019-01-17T11:02:04+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2012"},{"text":"%cassandra\nSELECT * from lbsn.users LIMIT 20;","user":"anonymous","dateUpdated":"2019-01-17T21:54:48+0530","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uid":"string","id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"uid\tid\n29720\t459\n29720\t1557\n29720\t29094\n3236\t29221\n3236\t66893\n3236\t66894\n28817\t4700\n28817\t4771\n182684\t131973\n137398\t46536\n137398\t114468\n142916\t49386\n142916\t49387\n142916\t49389\n28803\t511\n28803\t1201\n28803\t1537\n28803\t1999\n28803\t2081\n28803\t2169\n"}]},"apps":[],"jobName":"paragraph_1547703124382_-1248341893","id":"20190117-110204_1707142350","dateCreated":"2019-01-17T11:02:04+0530","dateStarted":"2019-01-17T11:07:08+0530","dateFinished":"2019-01-17T11:07:08+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2013"},{"text":"%cassandra\nSELECT * from lbsn.venues LIMIT 20;","user":"anonymous","dateUpdated":"2019-01-17T21:54:54+0530","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"vid":"string","lat":"string","lon":"string","name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"vid\tlat\tlon\tname\n12775\t40.7566595\t-73.92532825\tSunswick\n1198814\t40.7357349\t-74.0650162\tDosa House\n635262\t40.7529030907\t-73.9727635224\tKushi Q\n936046\t40.75202095\t-74.04536955\tC-Town\n587968\t40.718743483699996\t-73.9995074272\tLunch Box Buffet\n1533431\t40.744058553\t-73.97632204899999\tMidtown Animal Shelter\n1080058\t40.76757043\t-73.9821974\tGrom\n1335965\t40.642988338\t-74.012917892\tCitibank\n188513\t40.7251576833\t-73.9998233833\tSabon\n89271\t40.7258153167\t-74.0066860333\tNew York City Fire Museum\n200291\t40.7214571665\t-73.9574399164\tBrooklyn Brewery\n931093\t40.7601235794\t-73.988665234\tB. Smiths Restaurant\n1069921\t40.7798854\t-73.9505182667\tCavatappo\n1594710\t40.7537981933\t-74.1568862162\tChina Star\n356355\t40.696717408699996\t-74.18217659\tEWR Air Train Station P4\n848601\t40.7367220775\t-74.0303313732\tHoboken Pizza\n727507\t40.7291964934\t-73.9504359004\tBroadway Stages\n123258\t40.72544735\t-73.9981761667\tA.P.C.\n677582\t40.7696344167\t-73.90963263329999\tAstoria Veterinary Group\n1204811\t40.58278675\t-73.9534122667\tHolocaust memorial park\n"}]},"apps":[],"jobName":"paragraph_1547703403545_770856727","id":"20190117-110643_1008462735","dateCreated":"2019-01-17T11:06:43+0530","dateStarted":"2019-01-17T11:07:11+0530","dateFinished":"2019-01-17T11:07:11+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2014"},{"text":"%spark.dep\nz.reset() // clean up previously added artifact and repository\n// add artifact recursively\nz.load(\"datastax:spark-cassandra-connector:2.3.0-s_2.11\")\nz.load(\"commons-configuration:commons-configuration:1.10\")\n","user":"anonymous","dateUpdated":"2019-01-17T11:24:30+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@220a50aa\n"}]},"apps":[],"jobName":"paragraph_1547703431765_-611806708","id":"20190117-110711_1643554662","dateCreated":"2019-01-17T11:07:11+0530","dateStarted":"2019-01-17T11:24:30+0530","dateFinished":"2019-01-17T11:24:42+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2015"},{"text":"%spark\nimport com.datastax.spark.connector._\nimport org.apache.spark.sql.cassandra._\n","user":"anonymous","dateUpdated":"2019-01-17T11:24:59+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.datastax.spark.connector._\nimport org.apache.spark.sql.cassandra._\n"}]},"apps":[],"jobName":"paragraph_1547703923865_-1653248337","id":"20190117-111523_1767135118","dateCreated":"2019-01-17T11:15:23+0530","dateStarted":"2019-01-17T11:25:00+0530","dateFinished":"2019-01-17T11:25:14+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2016"},{"text":"%spark\n\nval events_data = spark.read.cassandraFormat(\"events\", \"lbsn\").load()\nval users_data = spark.read.cassandraFormat(\"users\", \"lbsn\").load()\nval venues_data = spark.read.cassandraFormat(\"venues\", \"lbsn\").load()\n","user":"anonymous","dateUpdated":"2019-01-17T11:46:00+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":87,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"events_data: org.apache.spark.sql.DataFrame = [uid: bigint, ts: timestamp ... 3 more fields]\nusers_data: org.apache.spark.sql.DataFrame = [uid: bigint, id: bigint]\nvenues_data: org.apache.spark.sql.DataFrame = [vid: bigint, lat: double ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547704499990_1988302626","id":"20190117-112459_279624516","dateCreated":"2019-01-17T11:24:59+0530","dateStarted":"2019-01-17T11:39:16+0530","dateFinished":"2019-01-17T11:39:17+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2017"},{"title":"Register a Temporary View","text":"%spark\n\n// Convert venues_data DataFrame to a temporary view\nevents_data.createOrReplaceTempView(\"events_data\")\nusers_data.createOrReplaceTempView(\"users_data\")\nvenues_data.createOrReplaceTempView(\"venues_data\")","user":"anonymous","dateUpdated":"2019-01-17T11:39:17+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1547704560538_1108238290","id":"20190117-112600_1951364971","dateCreated":"2019-01-17T11:26:00+0530","dateStarted":"2019-01-17T11:39:17+0530","dateFinished":"2019-01-17T11:39:18+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2018"},{"text":"%spark.sql\n\nSELECT * FROM venues_data LIMIT 30","user":"anonymous","dateUpdated":"2019-01-17T21:54:15+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"vid":"string","lat":"string","lon":"string","name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"vid\tlat\tlon\tname\n981359\t40.769824937399996\t-73.9818263054\tChase Bank - Broadway & 61st\n1350500\t40.634017323\t-74.022177417\tVinny's Pet Shop\n34132\t40.7299499182\t-73.9812072762\tPhoenix\n1123476\t40.8491948167\t-73.9691308833\tDong Bang Grill\n103599\t40.7250962843\t-73.9997793546\tKidrobot\n559578\t40.6900949667\t-73.9934552333\tAtlantic Avenue Tunnel\n739232\t40.733012051100005\t-73.9901075916\tPie\n91119\t40.759846237800005\t-73.9858925343\tEthel Barrymore Theatre\n1681050\t40.7506642\t-73.991332583\tBolt Bus Stop\n702220\t40.71584886\t-74.00728124\tABI\n230704\t40.77154719\t-73.95978707\tScoop\n866974\t40.739653576100004\t-73.9868143699\t280 Park Ave South\n313491\t40.7252278561\t-73.9924377201\tDouble Crown\n127346\t40.769500952899996\t-73.9893503281\tCBS Station Break Commissary\n5044522\t40.64827537\t-73.79220956\tAdmirals Club\n150138\t40.78823405\t-73.8135635833\tDunkin' Donuts\n3404057\t40.740882\t-73.991647\tCana\n3454384\t40.784069702\t-74.233721513\tThomas Edison National Historic Park\n800352\t40.63419145\t-74.0039783833\tStyle\n356162\t40.7585172\t-73.97025352\tBranch Club\n170414\t40.7424252888\t-73.9776329088\tWaterfront Ale House\n93228\t40.689514096799996\t-73.9925725758\tTrader Joe's\n111741\t40.7466104846\t-73.9908241466\tArt Directors Club\n3734169\t40.523217157\t-74.216306195\tHot Shotz Sports Bar\n58823\t40.752605054499995\t-73.9746379852\tThe Wheeltapper\n934880\t40.7366518667\t-73.99522595\tBig D\n329833\t40.7301592667\t-74.00672945\tOut Of The Kitchen\n2354747\t40.711044\t-74.005493\tThe Beekman Tower\n1347024\t40.75554775\t-73.885907467\tOmonia Café\n993696\t40.8551676592\t-73.9374625683\tBleu Evolution\n"}]},"apps":[],"jobName":"paragraph_1547704666504_1023362986","id":"20190117-112746_964032971","dateCreated":"2019-01-17T11:27:46+0530","dateStarted":"2019-01-17T11:39:18+0530","dateFinished":"2019-01-17T11:39:18+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2019"},{"text":"%spark.sql\n\nSELECT * FROM events_data LIMIT 30","user":"anonymous","dateUpdated":"2019-01-17T21:54:24+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uid":"string","ts":"string","lat":"string","lon":"string","vid":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"uid\tts\tlat\tlon\tvid\n34132\t2010-09-04 08:26:34.0\t40.774412748\t-73.87258702\t1505916\n34132\t2010-09-04 08:26:16.0\t40.7745781069\t-73.8720059395\t12505\n34132\t2010-09-01 11:04:16.0\t40.6891968241\t-74.0445041656\t11975\n34132\t2010-09-01 09:57:23.0\t40.7308686424\t-73.9975655079\t16397\n125933\t2010-04-22 17:28:05.0\t40.687276885\t-74.1826701164\t176536\n125933\t2010-04-22 15:13:07.0\t40.6997066969\t-73.8085234165\t28031\n125933\t2010-04-08 18:51:01.0\t40.6956965463\t-74.1771554947\t243314\n33434\t2010-08-12 17:40:16.0\t40.6454327055\t-73.785307629\t942628\n33434\t2010-08-12 17:31:40.0\t40.6438845363\t-73.78280639649999\t23261\n33434\t2010-08-12 15:41:35.0\t40.7560827679\t-73.9804865426\t577677\n33434\t2010-08-12 13:36:01.0\t40.755834813\t-73.980608643\t1335967\n33434\t2010-08-12 09:53:26.0\t40.722779328899996\t-73.99791394430001\t33366\n33434\t2010-08-11 22:43:59.0\t40.7290029\t-73.9991475167\t220069\n33434\t2010-08-11 21:33:34.0\t40.7039524755\t-74.01607275010001\t11738\n33434\t2010-08-11 19:14:40.0\t40.7250228232\t-73.9991104603\t19762\n33434\t2010-08-11 10:56:20.0\t40.7230144748\t-74.00345563890001\t26196\n33434\t2010-08-10 22:17:23.0\t40.7211921751\t-73.9950782514\t624853\n33434\t2010-06-30 09:07:02.0\t40.69233065\t-74.1810362333\t562012\n33434\t2010-04-01 18:48:14.0\t40.6430053298\t-73.782248497\t132282\n33434\t2010-04-01 16:58:25.0\t40.756497999699995\t-73.9734685421\t37286\n33434\t2010-04-01 12:54:56.0\t40.756497999699995\t-73.9734685421\t37286\n33434\t2010-03-31 17:24:27.0\t40.7612927545\t-73.97494912149999\t833055\n33434\t2010-03-31 16:31:56.0\t40.756497999699995\t-73.9734685421\t37286\n33434\t2010-03-31 14:01:08.0\t40.7646769907\t-73.9762443502\t66971\n49738\t2010-09-14 20:03:17.0\t40.7798996283\t-73.7757468224\t253740\n49738\t2010-09-03 21:57:10.0\t40.7633563333\t-73.7706057667\t399263\n49738\t2010-08-29 21:22:40.0\t40.764437415\t-73.77149413\t2739298\n49738\t2010-08-21 22:18:49.0\t40.76767665\t-73.79176539\t651769\n49738\t2010-08-05 22:31:35.0\t40.7180223131\t-73.95782576020001\t411413\n49738\t2010-08-05 19:35:46.0\t40.7314577366\t-74.0002718454\t33634\n"}]},"apps":[],"jobName":"paragraph_1547704695419_-1445063356","id":"20190117-112815_1117410719","dateCreated":"2019-01-17T11:28:15+0530","dateStarted":"2019-01-17T11:39:19+0530","dateFinished":"2019-01-17T11:39:19+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2020"},{"text":"%spark.sql\n\n\nSELECT * FROM users_data LIMIT 30","user":"anonymous","dateUpdated":"2019-01-17T13:35:46+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uid":"string","id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"uid\tid\n34132\t1346\n125933\t33403\n49738\t1362\n49738\t143135\n1269\t242\n1269\t372\n1269\t450\n1269\t459\n1269\t526\n1269\t527\n1269\t590\n1269\t662\n1269\t770\n1269\t900\n1269\t956\n1269\t1174\n1269\t1201\n1269\t1543\n1269\t1615\n1269\t1762\n1269\t1940\n1269\t1960\n1269\t2081\n1269\t2132\n1269\t2350\n1269\t2798\n1269\t3132\n1269\t3210\n1269\t4929\n1269\t5244\n"}]},"apps":[],"jobName":"paragraph_1547704852004_2061561354","id":"20190117-113052_26861457","dateCreated":"2019-01-17T11:30:52+0530","dateStarted":"2019-01-17T13:35:46+0530","dateFinished":"2019-01-17T13:35:46+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2021"},{"text":"%spark.sql\n\nselect vid, name from venues_data LIMIT 30\n","user":"anonymous","dateUpdated":"2019-01-17T13:36:04+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"vid":"string","name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"vid\tname\n981359\tChase Bank - Broadway & 61st\n1350500\tVinny's Pet Shop\n34132\tPhoenix\n1123476\tDong Bang Grill\n103599\tKidrobot\n559578\tAtlantic Avenue Tunnel\n739232\tPie\n91119\tEthel Barrymore Theatre\n1681050\tBolt Bus Stop\n702220\tABI\n230704\tScoop\n866974\t280 Park Ave South\n313491\tDouble Crown\n127346\tCBS Station Break Commissary\n5044522\tAdmirals Club\n150138\tDunkin' Donuts\n3404057\tCana\n3454384\tThomas Edison National Historic Park\n800352\tStyle\n356162\tBranch Club\n170414\tWaterfront Ale House\n93228\tTrader Joe's\n111741\tArt Directors Club\n3734169\tHot Shotz Sports Bar\n58823\tThe Wheeltapper\n934880\tBig D\n329833\tOut Of The Kitchen\n2354747\tThe Beekman Tower\n1347024\tOmonia Café\n993696\tBleu Evolution\n"}]},"apps":[],"jobName":"paragraph_1547705418990_-1284088012","id":"20190117-114018_1734221231","dateCreated":"2019-01-17T11:40:18+0530","dateStarted":"2019-01-17T13:36:05+0530","dateFinished":"2019-01-17T13:36:05+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2022"},{"text":"%spark\nval venues   = venues_data.select(\"vid\",\"name\")\nvenues.count\nvenues.where(\"vid = 12525\").first()","user":"anonymous","dateUpdated":"2019-01-17T11:50:00+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"venues: org.apache.spark.sql.DataFrame = [vid: bigint, name: string]\nres33: Long = 17291\nres34: org.apache.spark.sql.Row = [12525,The Museum of Modern Art (MoMA)]\n"}]},"apps":[],"jobName":"paragraph_1547704867663_1511004442","id":"20190117-113107_664371726","dateCreated":"2019-01-17T11:31:07+0530","dateStarted":"2019-01-17T11:50:00+0530","dateFinished":"2019-01-17T11:50:02+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2023"},{"text":"%spark\nval events   = spark.sql(\"\"\"select ts, uid, lat, lon, vid from events where\n                            lon>-74.2589 and lon<-73.7004 and \n                            lat> 40.4774 and lat< 40.9176\n                      \"\"\").as(\"events\").orderBy(\"uid\", \"ts\").repartition(8, $\"uid\").cache()\n","user":"anonymous","dateUpdated":"2019-01-17T12:23:14+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"events: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [ts: timestamp, uid: bigint ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547705881150_111423358","id":"20190117-114801_1428865946","dateCreated":"2019-01-17T11:48:01+0530","dateStarted":"2019-01-17T12:23:14+0530","dateFinished":"2019-01-17T12:23:16+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2024"},{"text":"%spark\n\nval events = events_data.select(\"ts\",\"uid\",\"lat\",\"lon\",\"vid\").where(\" lon>-74.2589 and lon<-73.7004 and lat> 40.4774 and lat< 40.9176\").orderBy(\"uid\",\"ts\").repartition(8, $\"uid\").cache()","user":"anonymous","dateUpdated":"2019-01-17T12:27:30+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"events: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [ts: timestamp, uid: bigint ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547708012953_-1635163601","id":"20190117-122332_1999993052","dateCreated":"2019-01-17T12:23:32+0530","dateStarted":"2019-01-17T12:27:30+0530","dateFinished":"2019-01-17T12:27:32+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2025"},{"text":"%md\n#### Explore the events data\nLet's start by looking at some recorded events. A quick way to do so is with the `show()` DataFrame Spark method.\nFeel free to modify the cells below to gain insight on the venue data. For instance, try the `take()`, `show()`, `count()` Spark DataFrame methods.","user":"anonymous","dateUpdated":"2019-01-17T12:32:55+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Explore the events data</h4>\n<p>Let&rsquo;s start by looking at some recorded events. A quick way to do so is with the <code>show()</code> DataFrame Spark method.<br/>Feel free to modify the cells below to gain insight on the venue data. For instance, try the <code>take()</code>, <code>show()</code>, <code>count()</code> Spark DataFrame methods.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547708551124_-1591218682","id":"20190117-123231_164837683","dateCreated":"2019-01-17T12:32:31+0530","dateStarted":"2019-01-17T12:32:55+0530","dateFinished":"2019-01-17T12:32:55+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2026"},{"text":"%spark\nevents.show(5)","user":"anonymous","dateUpdated":"2019-01-17T12:28:43+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+---+-------------+------------------+------+\n|                 ts|uid|          lat|               lon|   vid|\n+-------------------+---+-------------+------------------+------+\n|2010-04-18 18:53:48| 88| 40.645919692|    -73.7779355049| 17417|\n|2010-04-18 20:03:48| 88|40.7628367545|    -73.9825987816|150676|\n|2010-04-18 21:08:56| 88|    40.763479|-73.97908000000001|972311|\n|2010-04-19 09:34:48| 88|40.7417466987|     -73.993421425|105068|\n|2010-04-19 11:23:21| 88|40.7422661063|-73.98375749590001|851661|\n+-------------------+---+-------------+------------------+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1547708103176_120809297","id":"20190117-122503_266430091","dateCreated":"2019-01-17T12:25:03+0530","dateStarted":"2019-01-17T12:28:43+0530","dateFinished":"2019-01-17T12:28:47+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2027"},{"text":"%md\nBefore diving into anomaly detection of geolocated data, let's perform some more basic queries.  \nBelow, is shown how to count events registered by user `uid=0`.","user":"anonymous","dateUpdated":"2019-01-17T12:35:39+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Before diving into anomaly detection of geolocated data, let&rsquo;s perform some more basic queries.<br/>Below, is shown how to count events registered by user <code>uid=0</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547708733160_-739726554","id":"20190117-123533_892491415","dateCreated":"2019-01-17T12:35:33+0530","dateStarted":"2019-01-17T12:35:39+0530","dateFinished":"2019-01-17T12:35:39+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2028"},{"text":"%spark\n// User 0: how many check-ins?\n\nevents.where(\"uid=0\").count()","user":"anonymous","dateUpdated":"2019-01-17T12:31:53+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res51: Long = 25\n"}]},"apps":[],"jobName":"paragraph_1547708266178_-951082868","id":"20190117-122746_1262735063","dateCreated":"2019-01-17T12:27:46+0530","dateStarted":"2019-01-17T12:31:53+0530","dateFinished":"2019-01-17T12:31:54+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2029"},{"text":"%md\n#### Joining Cassandra/Scylla tables in Spark\n\nOne of the advantages of connecting Cassandra/Scylla  and Spark, is the fact that you can now merge and join Cassandra/Scylla  tables. You can actually keep coding with Spark DataFrames, as the join will happen in the background and the necessary queries will be pushed back from Spark to Cassandra/Scylla .","user":"anonymous","dateUpdated":"2019-01-17T12:36:55+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Joining Cassandra/Scylla tables in Spark</h4>\n<p>One of the advantages of connecting Cassandra/Scylla and Spark, is the fact that you can now merge and join Cassandra/Scylla tables. You can actually keep coding with Spark DataFrames, as the join will happen in the background and the necessary queries will be pushed back from Spark to Cassandra/Scylla .</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547708772453_-2075287285","id":"20190117-123612_1675237167","dateCreated":"2019-01-17T12:36:12+0530","dateStarted":"2019-01-17T12:36:55+0530","dateFinished":"2019-01-17T12:36:55+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2030"},{"text":"%spark\nval df_ny = events.\n  join(venues, Seq(\"vid\"), \"inner\").\n  select(\"ts\", \"uid\", \"lat\", \"lon\", \"vid\",\"name\")\n","user":"anonymous","dateUpdated":"2019-01-17T13:14:56+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_ny: org.apache.spark.sql.DataFrame = [ts: timestamp, uid: bigint ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547708513567_1969610081","id":"20190117-123153_445984967","dateCreated":"2019-01-17T12:31:53+0530","dateStarted":"2019-01-17T13:14:56+0530","dateFinished":"2019-01-17T13:14:56+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2031"},{"text":"%md\nOur Spark DataFrame df_ny above is going to be the starting point for our data analysis.     Each row records the event's timestamp, the user id, the geolocation (latitude and longitude) of the event, and finally the venue's id and venue's name.  \n\nBelow, let's have a look at 5 events checked in by `uid=0`, in no particular order.","user":"anonymous","dateUpdated":"2019-01-17T13:16:09+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Our Spark DataFrame df_ny above is going to be the starting point for our data analysis. Each row records the event&rsquo;s timestamp, the user id, the geolocation (latitude and longitude) of the event, and finally the venue&rsquo;s id and venue&rsquo;s name. </p>\n<p>Below, let&rsquo;s have a look at 5 events checked in by <code>uid=0</code>, in no particular order.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547708844754_-199623056","id":"20190117-123724_1116262975","dateCreated":"2019-01-17T12:37:24+0530","dateStarted":"2019-01-17T13:16:09+0530","dateFinished":"2019-01-17T13:16:10+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2032"},{"text":"%spark\ndf_ny.filter($\"uid\"===0).show(5,false)","user":"anonymous","dateUpdated":"2019-01-17T13:16:26+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+---+------------------+------------------+------+---------------------------------+\n|ts                 |uid|lat               |lon               |vid   |name                             |\n+-------------------+---+------------------+------------------+------+---------------------------------+\n|2010-10-08 23:07:03|0  |40.756879967399996|-73.98622512819999|11844 |Times Square                     |\n|2010-10-07 21:37:48|0  |40.7317243329     |-74.0033376217    |87914 |John's of Bleecker Street        |\n|2010-10-10 19:30:37|0  |40.729768314      |-73.9985353275    |260957|The Half Pint                    |\n|2010-10-08 19:13:52|0  |40.7070708167     |-74.0119528667    |15169 |Trinity Church                   |\n|2010-10-11 21:51:28|0  |40.6438845363     |-73.78280639649999|23261 |JFK John F. Kennedy International|\n+-------------------+---+------------------+------------------+------+---------------------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1547711041540_41263045","id":"20190117-131401_1824518078","dateCreated":"2019-01-17T13:14:01+0530","dateStarted":"2019-01-17T13:16:26+0530","dateFinished":"2019-01-17T13:16:27+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2033"},{"text":"%md\n#### Executing SQL with custom defined functions\nNext to the default set of pre-defined DataFrame and column functions, it is possible to define the user-defined-functions (UDFs). In the code below, we will create two UDFs to transform the timestamp to the day of the week and the hour of the day values, computed according to a given local time zone.","user":"anonymous","dateUpdated":"2019-01-17T13:19:23+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Executing SQL with custom defined functions</h4>\n<p>Next to the default set of pre-defined DataFrame and column functions, it is possible to define the user-defined-functions (UDFs). In the code below, we will create two UDFs to transform the timestamp to the day of the week and the hour of the day values, computed according to a given local time zone.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547711339672_1532111872","id":"20190117-131859_1189869120","dateCreated":"2019-01-17T13:18:59+0530","dateStarted":"2019-01-17T13:19:23+0530","dateFinished":"2019-01-17T13:19:23+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2034"},{"text":"%spark\n// UDF functions for SQL-like operations on columns\nimport org.joda.time.DateTime\nimport org.joda.time.DateTimeZone\n\nimport java.sql.Timestamp\nimport org.apache.spark.sql.functions.udf\n\nval  dayofweek = udf( (ts: Timestamp, tz: String) => {\n  val dt = new DateTime(ts,DateTimeZone.forID(tz))\n  // Monday starts at 1, but we would like to count from zero\n  dt.getDayOfWeek() -1\n})\n\nval  localhour = udf( (ts: Timestamp, tz: String) => {\n  val dt = new DateTime(ts,DateTimeZone.forID(tz))\n  dt.getHourOfDay()\n})","user":"anonymous","dateUpdated":"2019-01-17T22:22:10+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.joda.time.DateTime\nimport org.joda.time.DateTimeZone\nimport java.sql.Timestamp\nimport org.apache.spark.sql.functions.udf\ndayofweek: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function2>,IntegerType,Some(List(TimestampType, StringType)))\nlocalhour: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function2>,IntegerType,Some(List(TimestampType, StringType)))\n"}]},"apps":[],"jobName":"paragraph_1547711186078_-440343432","id":"20190117-131626_1990254062","dateCreated":"2019-01-17T13:16:26+0530","dateStarted":"2019-01-17T13:19:51+0530","dateFinished":"2019-01-17T13:19:53+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2035"},{"text":"%md\nAs you can see below, our newly defined functions `dayofweek` and `localhour` can be mixed and matched with other Spark SQL functions.\n","user":"anonymous","dateUpdated":"2019-01-17T13:20:49+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>As you can see below, our newly defined functions <code>dayofweek</code> and <code>localhour</code> can be mixed and matched with other Spark SQL functions.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547711268321_-1291373088","id":"20190117-131748_1605110417","dateCreated":"2019-01-17T13:17:48+0530","dateStarted":"2019-01-17T13:20:49+0530","dateFinished":"2019-01-17T13:20:49+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2036"},{"text":"%spark\nval indian_tz = \"Indian/Maldives\"\n\nval df = df_ny.\n  withColumn(\"dow\",  dayofweek($\"ts\", lit(indian_tz))).\n  withColumn(\"hour\", localhour($\"ts\", lit(indian_tz)))\ndf.printSchema()","user":"anonymous","dateUpdated":"2019-01-17T21:59:15+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"indian_tz: String = Indian/Maldives\ndf: org.apache.spark.sql.DataFrame = [ts: timestamp, uid: bigint ... 6 more fields]\nroot\n |-- ts: timestamp (nullable = true)\n |-- uid: long (nullable = true)\n |-- lat: double (nullable = true)\n |-- lon: double (nullable = true)\n |-- vid: long (nullable = true)\n |-- name: string (nullable = true)\n |-- dow: integer (nullable = false)\n |-- hour: integer (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1547711449634_-1660627509","id":"20190117-132049_626509969","dateCreated":"2019-01-17T13:20:49+0530","dateStarted":"2019-01-17T13:29:24+0530","dateFinished":"2019-01-17T13:29:24+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2037"},{"text":"%spark\n// select time and the extracted day of the week and day of the month\ndf.select(\"ts\", \"dow\", \"hour\").show(5, false)","user":"anonymous","dateUpdated":"2019-01-17T21:59:21+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+---+----+\n|ts                 |dow|hour|\n+-------------------+---+----+\n|2010-07-08 14:26:12|3  |13  |\n|2010-08-28 13:39:06|5  |13  |\n|2010-08-01 15:50:36|6  |15  |\n|2010-06-27 16:04:52|6  |15  |\n|2010-03-30 01:47:42|1  |1   |\n+-------------------+---+----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1547711498493_201743646","id":"20190117-132138_610571243","dateCreated":"2019-01-17T13:21:38+0530","dateStarted":"2019-01-17T13:29:57+0530","dateFinished":"2019-01-17T13:29:58+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2038"},{"text":"%md\n## Extracting user's preferences\n\n#### Basic statistics in Spark\n\nThe following code section shows how to collect global statistics and histograms per hour of the day and per day of the week. Histograms can be made more specific by aggregating the events according to a number of factors, such as:\n\n - Venue\n - Geographical area\n - Popular users\n - 1st, 2nd friend's circle\n \n\nTo start, let's compute the histogram, accumulating all events and aggregating by hour of the day and by day of the week. ","user":"anonymous","dateUpdated":"2019-01-17T13:31:39+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Extracting user&rsquo;s preferences</h2>\n<h4>Basic statistics in Spark</h4>\n<p>The following code section shows how to collect global statistics and histograms per hour of the day and per day of the week. Histograms can be made more specific by aggregating the events according to a number of factors, such as:</p>\n<ul>\n  <li>Venue</li>\n  <li>Geographical area</li>\n  <li>Popular users</li>\n  <li>1st, 2nd friend&rsquo;s circle</li>\n</ul>\n<p>To start, let&rsquo;s compute the histogram, accumulating all events and aggregating by hour of the day and by day of the week.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547711997518_543940701","id":"20190117-132957_319835561","dateCreated":"2019-01-17T13:29:57+0530","dateStarted":"2019-01-17T13:31:39+0530","dateFinished":"2019-01-17T13:31:39+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2039"},{"text":"%spark\n// histogram day of the week events\nval week_data = df.groupBy($\"dow\").count()\n\nweek_data.createOrReplaceTempView(\"week_data\")\n","user":"anonymous","dateUpdated":"2019-01-17T13:45:42+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"week_data: org.apache.spark.sql.DataFrame = [dow: int, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1547712024692_1763977417","id":"20190117-133024_1691728884","dateCreated":"2019-01-17T13:30:24+0530","dateStarted":"2019-01-17T13:45:42+0530","dateFinished":"2019-01-17T13:45:43+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2040"},{"text":"%spark.sql\nSELECT * FROM week_data\n","user":"anonymous","dateUpdated":"2019-01-20T12:22:40+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dow":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dow","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dow\tcount\n1\t15370\n6\t16063\n3\t16132\n5\t18167\n4\t16375\n2\t15665\n0\t14611\n"}]},"apps":[],"jobName":"paragraph_1547712132610_33372960","id":"20190117-133212_706872235","dateCreated":"2019-01-17T13:32:12+0530","dateStarted":"2019-01-17T13:45:49+0530","dateFinished":"2019-01-17T13:45:51+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2041"},{"text":"// histogram hour of the day events\nval hourly_data = df.groupBy($\"hour\").count()\n\nhourly_data.createOrReplaceTempView(\"hourly_data\")","user":"anonymous","dateUpdated":"2019-01-17T13:52:53+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"hourly_data: org.apache.spark.sql.DataFrame = [hour: int, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1547712939230_-1124195930","id":"20190117-134539_2004849686","dateCreated":"2019-01-17T13:45:39+0530","dateStarted":"2019-01-17T13:52:53+0530","dateFinished":"2019-01-17T13:52:53+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2042"},{"text":"%spark.sql\nSELECT * FROM hourly_data","user":"anonymous","dateUpdated":"2019-01-20T12:22:41+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"hour":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false}},"commonSetting":{},"keys":[{"name":"hour","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hour\tcount\n12\t5886\n22\t5728\n1\t2220\n13\t7418\n16\t7218\n6\t595\n3\t728\n20\t8713\n5\t345\n19\t8565\n15\t7704\n17\t7642\n9\t3759\n4\t517\n8\t2375\n23\t4544\n7\t1183\n10\t4749\n21\t7068\n11\t5107\n14\t8086\n2\t1251\n0\t3298\n18\t7684\n"}]},"apps":[],"jobName":"paragraph_1547713281114_-1649384360","id":"20190117-135121_2087854607","dateCreated":"2019-01-17T13:51:21+0530","dateStarted":"2019-01-17T13:53:08+0530","dateFinished":"2019-01-17T13:53:10+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2043"},{"text":"%md\n#### Statistics in Spark: venue-specific histograms\n\nAbove, you'll see that we have extracted general patterns and looked at the histograms of events across all users and all venues. Moving on, let's have a look at how to create a specific histogram for each venue. \n\n#### Working with vectors as DataFrame elements\nWorking with vectors as DataFrame elements is a very powerful modeling technique, which, by the way, is extensively used in Spark ML. Having vectors as elements, allows you to use many vector arithmetic and logical operations as well as a great list of vector transformations as provided in the Spark ML library: <a href=\"http://spark.apache.org/docs/latest/ml-features.html\" target=\"_blank\">http://spark.apache.org/docs/latest/ml-features.html</a>, while you still keep the data in a DataFrame. \n\nWe will store the day and month histogram as a vector. First, let's convert the day-of-the-week to a vector.\n","user":"anonymous","dateUpdated":"2019-01-17T14:17:54+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Statistics in Spark: venue-specific histograms</h4>\n<p>Above, you&rsquo;ll see that we have extracted general patterns and looked at the histograms of events across all users and all venues. Moving on, let&rsquo;s have a look at how to create a specific histogram for each venue. </p>\n<h4>Working with vectors as DataFrame elements</h4>\n<p>Working with vectors as DataFrame elements is a very powerful modeling technique, which, by the way, is extensively used in Spark ML. Having vectors as elements, allows you to use many vector arithmetic and logical operations as well as a great list of vector transformations as provided in the Spark ML library: <a href=\"http://spark.apache.org/docs/latest/ml-features.html\" target=\"_blank\"><a href=\"http://spark.apache.org/docs/latest/ml-features.html\">http://spark.apache.org/docs/latest/ml-features.html</a></a>, while you still keep the data in a DataFrame. </p>\n<p>We will store the day and month histogram as a vector. First, let&rsquo;s convert the day-of-the-week to a vector.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547713388835_-162463935","id":"20190117-135308_758544547","dateCreated":"2019-01-17T13:53:08+0530","dateStarted":"2019-01-17T14:17:54+0530","dateFinished":"2019-01-17T14:17:54+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2044"},{"text":"%spark\n// import org.apache.spark.ml.linalg._\n// import org.apache.spark.ml.linalg.DenseVector\n\nimport org.apache.spark.mllib.linalg.{Vector,Vectors,DenseVector}\n\nimport org.apache.spark.mllib.linalg.{Vector,Vectors}\n\ndef r(x: Double, d:Int) = { \n    import scala.math.{pow, round}\n    val p = pow(10,d); round(x*p)/p \n}\n","user":"anonymous","dateUpdated":"2019-01-17T15:03:34+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.mllib.linalg.{Vector, Vectors, DenseVector}\nimport org.apache.spark.mllib.linalg.{Vector, Vectors}\nr: (x: Double, d: Int)Double\n"}]},"apps":[],"jobName":"paragraph_1547714560879_1427801467","id":"20190117-141240_2141376463","dateCreated":"2019-01-17T14:12:40+0530","dateStarted":"2019-01-17T15:03:34+0530","dateFinished":"2019-01-17T15:03:34+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2045"},{"text":"%spark\n// vector histogram\n\ndef toVector(i: Int, length:Int) = {\n  Vectors.dense((0 to length-1).map(x => if (x == i) 1.0 else 0.0).toArray)\n}","user":"anonymous","dateUpdated":"2019-01-17T14:37:25+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"toVector: (i: Int, length: Int)org.apache.spark.mllib.linalg.Vector\n"}]},"apps":[],"jobName":"paragraph_1547715249803_-367183587","id":"20190117-142409_1797782698","dateCreated":"2019-01-17T14:24:09+0530","dateStarted":"2019-01-17T14:37:25+0530","dateFinished":"2019-01-17T14:37:26+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2046"},{"text":"%md\nVectors are Mondays to Sundays ( values go from 0 to 6).\nAs an example, let's see which vector is produced from this event on Friday.\nThe value 4, turns in to a '1' on the 5th position in the day of the week vector: it is a Friday :)","user":"anonymous","dateUpdated":"2019-01-17T14:31:40+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Vectors are Mondays to Sundays ( values go from 0 to 6).<br/>As an example, let&rsquo;s see which vector is produced from this event on Friday.<br/>The value 4, turns in to a &lsquo;1&rsquo; on the 5th position in the day of the week vector: it is a Friday :)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547715265781_306567265","id":"20190117-142425_58408781","dateCreated":"2019-01-17T14:24:25+0530","dateStarted":"2019-01-17T14:31:40+0530","dateFinished":"2019-01-17T14:31:40+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2047"},{"text":"%spark\ndf.select(\"vid\", \"ts\", \"dow\").first()","user":"anonymous","dateUpdated":"2019-01-17T14:37:35+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res115: org.apache.spark.sql.Row = [981359,2010-07-08 14:26:12.0,3]\n"}]},"apps":[],"jobName":"paragraph_1547715700031_1786464348","id":"20190117-143140_833518668","dateCreated":"2019-01-17T14:31:40+0530","dateStarted":"2019-01-17T14:37:35+0530","dateFinished":"2019-01-17T14:37:35+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2048"},{"text":"%spark\ndf.select($\"vid\", $\"dow\").map(r => (r.getLong(0),toVector(r.getInt(1), 7))).as[(Long,Vector)].first()","user":"anonymous","dateUpdated":"2019-01-17T15:33:05+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res186: (Long, org.apache.spark.mllib.linalg.Vector) = (981359,[0.0,0.0,0.0,1.0,0.0,0.0,0.0])\n"}]},"apps":[],"jobName":"paragraph_1547715726791_250781262","id":"20190117-143206_517991247","dateCreated":"2019-01-17T14:32:06+0530","dateStarted":"2019-01-17T15:33:05+0530","dateFinished":"2019-01-17T15:33:06+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2049"},{"text":"%spark\ndf.select($\"vid\", $\"dow\").map(r => (r.getLong(0),toVector(r.getInt(1), 7))).collect.filter(x => x._1 == 513544)\n// show(5,false)\n","user":"anonymous","dateUpdated":"2019-01-17T15:30:40+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res181: Array[(Long, org.apache.spark.mllib.linalg.Vector)] = Array((513544,[0.0,0.0,0.0,0.0,0.0,1.0,0.0]), (513544,[1.0,0.0,0.0,0.0,0.0,0.0,0.0]), (513544,[1.0,0.0,0.0,0.0,0.0,0.0,0.0]))\n"}]},"apps":[],"jobName":"paragraph_1547718881828_-1638656413","id":"20190117-152441_127593906","dateCreated":"2019-01-17T15:24:41+0530","dateStarted":"2019-01-17T15:30:40+0530","dateFinished":"2019-01-17T15:30:42+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2050"},{"text":"%spark\nval dow_hist = df.select($\"vid\", $\"dow\").map(r => (r.getLong(0),toVector(r.getInt(1), 7))).filter(\"vid == '513544'\").show(5,false)\n\n\n//   select($\"vid\", $\"dow\")//.\n//   mapValues(x => Vectors.dense((x / sum(x)).toArray.map(r(_,2)))).\n//   toDF(\"vid\", \"dow_hist\")","user":"anonymous","dateUpdated":"2019-01-20T12:23:24+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1547715752686_-1237385562","id":"20190117-143232_798273272","dateCreated":"2019-01-17T14:32:32+0530","dateStarted":"2019-01-17T15:23:56+0530","dateFinished":"2019-01-17T15:23:56+0530","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2051","errorMessage":""}],"name":"Spark with Scylla/Anomaly detection and pattern extraction with Spark, Scylla, and Scala","id":"2E2PVSD9E","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[],"cassandra:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}